<% @title="Guestbook Index" %>
<div class="guestbook-index">
  <nav>
    <% if @current_page > 0%>
      <%= link_to "Previous page", guestbook_index_path(page: (@current_page - 1))%>
    <% end %>
  </nav>
  <div class="container">
    <div><%= link_to "New Entry", new_guestbook_path, class: "link-button" %></div>
    <% if @entries.length == 0 %>
      <div class="warning">
        Looks like there's nothing here...
      </div>
    <% end %>
    <% @entries.each do |entry| %>
      <div class="entry-blurb">
        <div>
          <div class="author">
            <span><%= entry.name %></span>
          </div>
          <% if entry.home_site && entry.home_site != ""%>
            <div class="home-site">
              Home site: <%= entry.home_site %>
            </div>
          <% end %>
          <% if (current_user || !entry.hide_contact_from_public) && entry.contact != "" %>
            <div class="contact">
              <% if entry.hide_contact_from_public %>
                <div class="warning">Hidden</div>
              <% end %>
              Contact: <%= entry.contact %>
            </div>
          <% end %>
          <div class="body">
            <%= entry.body %>
          </div>
          <footer class="datetime-footer">Sent: <%= entry.created_at.strftime("%B #{entry.created_at.day.ordinalize}, %Y at %I:%M %p") %>.</footer>
          <% if current_user %>
            <div class="destroy-link">
              <%= link_to "Destroy", guestbook_path(entry), data: {
                          turbo_method: :delete,
                          turbo_confirm: "Are you sure you want to delete this guestbook entry (by #{entry.name})?"
                        } %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
  <nav>
    <% if @entries.length > 0 && @entries.length == @page_size %>
      <%= link_to "Next page", guestbook_index_path(page: (@current_page + 1))%>
    <% end %>
  </nav>
</div>
